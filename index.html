<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>نظام تقييم استحقاق الأسر للمساعدات</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #4361ee;
            --primary-light: #4895ef;
            --secondary: #3f37c9;
            --accent: #f72585;
            --success: #4cc9f0;
            --warning: #f8961e;
            --danger: #ef233c;
            --light: #f8f9fa;
            --dark: #212529;
            --gray: #6c757d;
            --border-radius: 12px;
            --box-shadow: 0 8px 24px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s cubic-bezier(0.25, 0.8, 0.25, 1);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: 'Tajawal', sans-serif;
            background: linear-gradient(135deg, #f5f7fa 0%, #e4e8f0 100%);
            color: var(--dark);
            line-height: 1.6;
            padding: 20px;
            min-height: 100vh;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background-color: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            overflow: hidden;
            position: relative;
            z-index: 1;
        }

        .container::before {
            content: '';
            position: absolute;
            top: 0;
            right: 0;
            width: 100%;
            height: 8px;
            background: linear-gradient(90deg, var(--primary) 0%, var(--accent) 100%);
            z-index: 2;
        }

        textarea {
            min-height: 100px;
            resize: vertical;
        }

        #purchasedItemsGroup {
            display: none;
        }
        
        #providerGroup {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #eee;
        }

        .fa-shopping-cart {
            color: var(--success);
        }
        
        h1 {
            color: var(--primary);
            font-size: 2.2rem;
            margin-bottom: 10px;
            position: relative;
            display: inline-block;
        }

        h1::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 60px;
            height: 4px;
            background-color: var(--accent);
            border-radius: 2px;
        }

        h2 {
            color: var(--secondary);
            font-size: 1.5rem;
            margin: 25px 0 15px;
            padding-right: 15px;
            border-right: 4px solid var(--primary-light);
            display: flex;
            align-items: center;
            gap: 10px;
        }

        h3 {
            color: var(--primary);
            font-size: 1.2rem;
            margin: 20px 0 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .form-content {
            padding: 0 30px 30px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
            color: var(--dark);
            position: relative;
            padding-right: 20px;
        }

        label.required::after {
            content: '*';
            color: var(--danger);
            position: absolute;
            right: 5px;
            top: 0;
        }

        input, select, textarea {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ddd;
            border-radius: var(--border-radius);
            font-family: 'Tajawal', sans-serif;
            font-size: 1rem;
            transition: var(--transition);
            background-color: rgba(255, 255, 255, 0.8);
        }

        input:focus, select:focus, textarea:focus {
            border-color: var(--primary);
            box-shadow: 0 0 0 3px rgba(67, 97, 238, 0.2);
            outline: none;
        }

        button {
            background: linear-gradient(135deg, var(--primary) 0%, var(--secondary) 100%);
            color: white;
            padding: 14px 28px;
            border: none;
            border-radius: 50px;
            font-size: 1.1rem;
            font-weight: 500;
            cursor: pointer;
            transition: var(--transition);
            box-shadow: 0 4px 15px rgba(67, 97, 238, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin: 30px auto;
            width: fit-content;
        }

        button:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(67, 97, 238, 0.4);
        }

        button:active {
            transform: translateY(0);
        }

        .device-card {
            background-color: white;
            border-radius: var(--border-radius);
            padding: 20px;
            margin: 15px 0;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            border-left: 4px solid var(--primary-light);
            transition: var(--transition);
        }

        .device-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .device-count {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 10px;
            flex-wrap: wrap;
        }

        .device-count > div {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .device-count input {
            width: 80px;
            text-align: center;
        }

        .damage-type-group {
            margin-top: 15px;
            padding-right: 15px;
            border-right: 2px solid #eee;
            margin-bottom: 15px;
            animation: fadeIn 0.3s ease;
        }

        .other-input {
            margin-top: 10px;
            animation: fadeIn 0.3s ease;
        }

        .requests-group {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-top: 15px;
        }

        .request-item {
            position: relative;
        }

        .request-item input[type="checkbox"] {
            position: absolute;
            opacity: 0;
            width: 0;
            height: 0;
        }

        .request-item label {
            display: inline-block;
            padding: 10px 15px;
            background-color: #f0f4f8;
            border-radius: 50px;
            cursor: pointer;
            transition: var(--transition);
            border: 1px solid #ddd;
            margin: 0;
            padding-right: 35px;
        }

        .request-item input[type="checkbox"]:checked + label {
            background-color: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .request-item label::before {
            content: '';
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            width: 16px;
            height: 16px;
            border: 2px solid var(--gray);
            border-radius: 3px;
            transition: var(--transition);
        }

        .request-item input[type="checkbox"]:checked + label::before {
            border-color: white;
            background-color: white;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%234361ee'%3E%3Cpath d='M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: center;
            background-size: 12px;
        }

        .radio-group {
            display: flex;
            gap: 20px;
            margin-top: 10px;
        }

        .radio-item {
            position: relative;
        }

        .radio-item input[type="radio"] {
            position: absolute;
            opacity: 0;
            width: 0;
            height: 0;
        }

        .radio-item label {
            display: inline-block;
            padding: 8px 15px 8px 30px;
            cursor: pointer;
            transition: var(--transition);
            margin: 0;
        }

        .radio-item label::before {
            content: '';
            position: absolute;
            right: 0;
            top: 50%;
            transform: translateY(-50%);
            width: 18px;
            height: 18px;
            border: 2px solid var(--gray);
            border-radius: 50%;
            transition: var(--transition);
        }

        .radio-item input[type="radio"]:checked + label::before {
            border-color: var(--primary);
            background-color: var(--primary);
            box-shadow: inset 0 0 0 3px white;
        }

        .result-container {
            margin-top: 40px;
            padding: 30px;
            border-radius: var(--border-radius);
            background-color: white;
            box-shadow: var(--box-shadow);
            display: none;
            animation: fadeIn 0.5s ease;
        }

        .result-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #eee;
        }

        .result-title {
            color: var(--primary);
            font-size: 1.5rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .rating-badge {
            padding: 8px 15px;
            border-radius: 50px;
            font-weight: 700;
            font-size: 1.1rem;
            display: inline-flex;
            align-items: center;
            gap: 8px;
        }

        .rating-badge.A {
            background-color: rgba(40, 167, 69, 0.1);
            color: #28a745;
        }

        .rating-badge.B {
            background-color: rgba(255, 193, 7, 0.1);
            color: #ffc107;
        }

        .rating-badge.C {
            background-color: rgba(220, 53, 69, 0.1);
            color: #dc3545;
        }

        .eligibility-status {
            padding: 20px;
            border-radius: var(--border-radius);
            margin-bottom: 25px;
            font-size: 1.1rem;
            line-height: 1.8;
            display: flex;
            align-items: flex-start;
            gap: 15px;
        }

        .eligibility-status.eligible {
            background-color: rgba(40, 167, 69, 0.1);
            border-left: 4px solid #28a745;
        }

        .eligibility-status.not-eligible {
            background-color: rgba(220, 53, 69, 0.1);
            border-left: 4px solid #dc3545;
        }

        .devices-list {
            margin-top: 20px;
        }

        .device-item {
            padding: 15px;
            margin-bottom: 10px;
            background-color: #f8f9fa;
            border-radius: var(--border-radius);
            display: flex;
            align-items: center;
            gap: 10px;
            transition: var(--transition);
        }

        .device-item:hover {
            background-color: #e9ecef;
            transform: translateX(5px);
        }

        .device-item i {
            color: var(--primary);
            font-size: 1.2rem;
        }

        .progress-container {
            margin-top: 30px;
            background-color: #f1f3f5;
            border-radius: 50px;
            height: 10px;
            overflow: hidden;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, var(--primary) 0%, var(--accent) 100%);
            border-radius: 50px;
            transition: width 1s ease;
        }

        .progress-labels {
            display: flex;
            justify-content: space-between;
            margin-top: 10px;
            font-size: 0.9rem;
            color: var(--gray);
        }

        .visual-rating {
            display: flex;
            justify-content: center;
            margin: 30px 0;
        }

        .rating-circle {
            width: 120px;
            height: 120px;
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
        }

        .rating-circle::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: conic-gradient(
                var(--primary) 0%,
                var(--accent) 100%
            );
            opacity: 0.1;
            z-index: 0;
        }

        .rating-circle.A {
            color: #28a745;
            border: 5px solid rgba(40, 167, 69, 0.3);
        }

        .rating-circle.B {
            color: #ffc107;
            border: 5px solid rgba(255, 193, 7, 0.3);
        }

        .rating-circle.C {
            color: #dc3545;
            border: 5px solid rgba(220, 53, 69, 0.3);
        }

        .rating-circle .letter {
            font-size: 2.5rem;
            line-height: 1;
            z-index: 1;
        }

        .rating-circle .text {
            font-size: 0.9rem;
            margin-top: 5px;
            z-index: 1;
        }
        
        .washer-condition {
            background-color: #e9f7ef;
            border-radius: var(--border-radius);
            padding: 15px;
            margin-top: 15px;
            border-left: 4px solid #28a745;
        }
        
        .washer-condition.not-met {
            background-color: #fbeaea;
            border-left: 4px solid #dc3545;
        }
        
        .condition-title {
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: bold;
            margin-bottom: 10px;
        }
        
        .condition-desc {
            font-size: 0.95rem;
        }
        
        .calculation-info {
            background-color: #e7f3ff;
            border-radius: var(--border-radius);
            padding: 15px;
            margin-top: 15px;
            border-left: 4px solid var(--primary);
        }
        
        .calculation-title {
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: bold;
            margin-bottom: 10px;
            color: var(--primary);
        }
        
        .calculation-desc {
            font-size: 0.95rem;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @media (max-width: 768px) {
            .container {
                border-radius: 0;
                box-shadow: none;
            }
            
            header, .form-content {
                padding: 20px;
            }
            
            h1 {
                font-size: 1.8rem;
            }
            
            h2 {
                font-size: 1.3rem;
            }
            
            .device-count {
                flex-direction: column;
                align-items: flex-start;
                gap: 10px;
            }
            
            .requests-group {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .radio-group {
                flex-direction: column;
                gap: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1><i class="fas fa-hand-holding-heart"></i> نظام تقييم استحقاق الأسر للمساعدات</h1>
            <p>نظام قائم لتقييم الحالات الخاصة بنشاط المساعدات</p>
        </header>
        
        <div class="form-content">
            <form id="familyForm">
                <div class="form-section">
                    <h2><i class="fas fa-users"></i> بيانات الأسرة</h2>
                    
                    <div class="form-group">
                        <label for="familyType" class="required">نوع الأسرة:</label>
                        <select id="familyType" required>
                            <option value="">-- اختر نوع الأسرة --</option>
                            <option value="engaged">عروسة مخطوبة</option>
                            <option value="married">عروسة مكتوب كتابها</option>
                            <option value="family">أسرة</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="familyName" class="required">اسم الأسرة / العروسة:</label>
                        <input type="text" id="familyName" required placeholder="أدخل اسم الأسرة أو العروسة">
                    </div>

                    <div id="providerGroup" class="form-group" style="display: none;">
                        <label>هل يوجد عائل للعروسة؟</label>
                        <div class="radio-group">
                            <div class="radio-item">
                                <input type="radio" name="hasProvider" value="yes" id="providerYes">
                                <label for="providerYes">نعم</label>
                            </div>
                            <div class="radio-item">
                                <input type="radio" name="hasProvider" value="no" id="providerNo" checked>
                                <label for="providerNo">لا</label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="familySize" class="required">عدد أفراد الأسرة:</label>
                        <input type="number" id="familySize" min="1" required placeholder="أدخل عدد الأفراد">
                    </div>
                    
                    <div id="elderlyGroup" class="form-group" style="display:none;">
                        <label>هل يوجد مسن في الأسرة؟</label>
                        <div class="radio-group">
                            <div class="radio-item">
                                <input type="radio" name="hasElderly" value="yes" id="elderlyYes">
                                <label for="elderlyYes">نعم</label>
                            </div>
                            <div class="radio-item">
                                <input type="radio" name="hasElderly" value="no" id="elderlyNo" checked>
                                <label for="elderlyNo">لا</label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="income" class="required">الدخل الشهري (جنيه):</label>
                        <input type="number" id="income" min="0" required placeholder="أدخل إجمالي الدخل الشهري">
                    </div>
                    
                    <div class="form-group">
                        <label for="expenses" class="required">المصروفات الشهرية (جنيه):</label>
                        <input type="number" id="expenses" min="0" required placeholder="أدخل إجمالي المصروفات الشهرية">
                    </div>
                </div>
                
                <div class="form-section">
                    <h2><i class="fas fa-couch"></i> الأجهزة المتوفرة حالياً</h2>
                    
                    <div class="device-card">
                        <h3><i class="fas fa-bed"></i> الأسرة والمراتب</h3>
                        
                        <div class="device-count">
                            <div>
                                <label for="bedsCount">عدد السرير المتوفرة:</label>
                                <input type="number" id="bedsCount" min="0" value="0">
                            </div>
                            <div>
                                <label for="damagedBedsCount">عدد التالف منها:</label>
                                <input type="number" id="damagedBedsCount" min="0" value="0">
                            </div>
                        </div>
                        
                        <div class="device-count">
                            <div>
                                <label for="mattressesCount">عدد المراتب المتوفرة:</label>
                                <input type="number" id="mattressesCount" min="0" value="0">
                            </div>
                            <div>
                                <label for="damagedMattressesCount">عدد التالف منها:</label>
                                <input type="number" id="damagedMattressesCount" min="0" value="0">
                            </div>
                        </div>
                    </div>
                    
                    <div class="device-card">
                        <h3><i class="fas fa-utensils"></i> أجهزة المطبخ</h3>
                        
                        <div class="device-count">
                            <div>
                                <label for="stovesCount">عدد البوتجاز المتوفرة:</label>
                                <input type="number" id="stovesCount" min="0" value="0">
                            </div>
                            <div>
                                <label for="damagedStovesCount">عدد التالف منها:</label>
                                <input type="number" id="damagedStovesCount" min="0" value="0">
                            </div>
                        </div>
                        
                        <div id="stoveDamageTypeGroup" class="damage-type-group" style="display: none;">
                            <label for="stoveDamageType">نوع تلف البوتجاز:</label>
                            <select id="stoveDamageType" onchange="toggleStoveOther(this)">
                                <option value="بيهب">بيهب</option>
                                <option value="بيسرب غاز">بيسرب غاز</option>
                                <option value="برومة">برومة</option>
                                <option value="غير ذلك">غير ذلك</option>
                            </select>
                            <div id="stoveOther" class="other-input" style="display: none;">
                                <input type="text" placeholder="حدد نوع التلف">
                            </div>
                        </div>
                        
                        <div id="stoveRepairAttemptGroup" class="damage-type-group" style="display: none;">
                            <label>هل تم محاولة إصلاحه من قبل؟</label>
                            <div class="radio-group">
                                <div class="radio-item">
                                    <input type="radio" name="stoveRepairAttempt" value="yes" id="stoveRepairYes">
                                    <label for="stoveRepairYes">نعم</label>
                                </div>
                                <div class="radio-item">
                                    <input type="radio" name="stoveRepairAttempt" value="no" id="stoveRepairNo" checked>
                                    <label for="stoveRepairNo">لا</label>
                                </div>
                            </div>
                        </div>
                        
                        <div style="margin-top: 15px;">
                            <div class="request-item">
                                <input type="checkbox" id="hasOven">
                                <label for="hasOven"><i class="fas fa-fire"></i> لديهم فرن</label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="device-card">
                        <h3><i class="fas fa-washing-machine"></i> الغسالات</h3>
                        
                        <div class="device-count">
                            <div>
                                <label for="washersCount">عدد الغسالات العادية المتوفرة:</label>
                                <input type="number" id="washersCount" min="0" value="0">
                            </div>
                            <div>
                                <label for="damagedWashersCount">عدد التالف منها:</label>
                                <input type="number" id="damagedWashersCount" min="0" value="0">
                            </div>
                        </div>
                        
                        <div id="washerDamageTypeGroup" class="damage-type-group" style="display: none;">
                            <label for="washerDamageType">نوع تلف الغسالة العادية:</label>
                            <select id="washerDamageType" onchange="toggleWasherOther(this)">
                                <option value="موتور">موتور</option>
                                <option value="برومة">برومة</option>
                                <option value="عصر">عصر</option>
                                <option value="مروحة">مروحة</option>
                                <option value="غير ذلك">غير ذلك</option>
                            </select>
                            <div id="washerOther" class="other-input" style="display: none;">
                                <input type="text" placeholder="حدد نوع التلف">
                            </div>
                        </div>
                        
                        <div id="washerRepairAttemptGroup" class="damage-type-group" style="display: none;">
                            <label>هل تم محاولة إصلاحه من قبل؟</label>
                            <div class="radio-group">
                                <div class="radio-item">
                                    <input type="radio" name="washerRepairAttempt" value="yes" id="washerRepairYes">
                                    <label for="washerRepairYes">نعم</label>
                                </div>
                                <div class="radio-item">
                                    <input type="radio" name="washerRepairAttempt" value="no" id="washerRepairNo" checked>
                                    <label for="washerRepairNo">لا</label>
                                </div>
                            </div>
                        </div>

                        <div class="device-count">
                            <div>
                                <label for="halfWashersCount">عدد الغسالات هاف المتوفرة:</label>
                                <input type="number" id="halfWashersCount" min="0" value="0">
                            </div>
                            <div>
                                <label for="damagedHalfWashersCount">عدد التالف منها:</label>
                                <input type="number" id="damagedHalfWashersCount" min="0" value="0">
                            </div>
                        </div>
                        
                        <div id="halfWasherDamageTypeGroup" class="damage-type-group" style="display: none;">
                            <label for="halfWasherDamageType">نوع تلف الغسالة الهاف:</label>
                            <select id="halfWasherDamageType" onchange="toggleHalfWasherOther(this)">
                                <option value="موتور">موتور</option>
                                <option value="برومة">برومة</option>
                                <option value="عصر">عصر</option>
                                <option value="مروحة">مروحة</option>
                                <option value="غير ذلك">غير ذلك</option>
                            </select>
                            <div id="halfWasherOther" class="other-input" style="display: none;">
                                <input type="text" placeholder="حدد نوع التلف">
                            </div>
                        </div>
                        
                        <div id="halfWasherRepairAttemptGroup" class="damage-type-group" style="display: none;">
                            <label>هل تم محاولة إصلاحه من قبل؟</label>
                            <div class="radio-group">
                                <div class="radio-item">
                                    <input type="radio" name="halfWasherRepairAttempt" value="yes" id="halfWasherRepairYes">
                                    <label for="halfWasherRepairYes">نعم</label>
                                </div>
                                <div class="radio-item">
                                    <input type="radio" name="halfWasherRepairAttempt" value="no" id="halfWasherRepairNo" checked>
                                    <label for="halfWasherRepairNo">لا</label>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="device-card">
                        <h3><i class="fas fa-snowflake"></i> الثلاجات</h3>
                        
                        <div class="device-count">
                            <div>
                                <label for="fridgesCount">عدد الثلاجات المتوفرة:</label>
                                <input type="number" id="fridgesCount" min="0" value="0">
                            </div>
                            <div>
                                <label for="damagedFridgesCount">عدد التالف منها:</label>
                                <input type="number" id="damagedFridgesCount" min="0" value="0">
                            </div>
                        </div>
                        
                        <div id="fridgeDamageTypeGroup" class="damage-type-group" style="display: none;">
                            <label for="fridgeDamageType">نوع تلف الثلاجة:</label>
                            <select id="fridgeDamageType" onchange="toggleFridgeOther(this)">
                                <option value="موتور">موتور</option>
                                <option value="برومة">برومة</option>
                                <option value="باب الثلاجة مكسور">باب الثلاجة مكسور</option>
                                <option value="غير ذلك">غير ذلك</option>
                            </select>
                            <div id="fridgeOther" class="other-input" style="display: none;">
                                <input type="text" placeholder="حدد نوع التلف">
                            </div>
                        </div>
                        
                        <div id="fridgeRepairAttemptGroup" class="damage-type-group" style="display: none;">
                            <label>هل تم محاولة إصلاحه من قبل؟</label>
                            <div class="radio-group">
                                <div class="radio-item">
                                    <input type="radio" name="fridgeRepairAttempt" value="yes" id="fridgeRepairYes">
                                    <label for="fridgeRepairYes">نعم</label>
                                </div>
                                <div class="radio-item">
                                    <input type="radio" name="fridgeRepairAttempt" value="no" id="fridgeRepairNo" checked>
                                    <label for="fridgeRepairNo">لا</label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="form-section">
                    <h2><i class="fas fa-hands-helping"></i> الطلبات والاحتياجات</h2>
                    
                    <div class="form-group">
                        <label>الطلبات على لسان الأسرة:</label>
                        <div class="requests-group">
                            <div class="request-item">
                                <input type="checkbox" name="requests" value="ثلاجة" id="requestFridge">
                                <label for="requestFridge"><i class="fas fa-snowflake"></i> ثلاجة</label>
                            </div>
                            <div class="request-item">
                                <input type="checkbox" name="requests" value="غسالة" id="requestWasher">
                                <label for="requestWasher"><i class="fas fa-washing-machine"></i> غسالة</label>
                            </div>
                            <div class="request-item">
                                <input type="checkbox" name="requests" value="بوتجاز" id="requestStove">
                                <label for="requestStove"><i class="fas fa-fire"></i> بوتجاز</label>
                            </div>
                            <div class="request-item">
                                <input type="checkbox" name="requests" value="سرير" id="requestBed">
                                <label for="requestBed"><i class="fas fa-bed"></i> سرير</label>
                            </div>
                            <div class="request-item">
                                <input type="checkbox" name="requests" value="مرتبة" id="requestMattress">
                                <label for="requestMattress"><i class="fas fa-bed"></i> مرتبة</label>
                            </div>
                            <div class="request-item">
                                <input type="checkbox" name="requests" value="غير ذلك" id="requestOther" onchange="toggleOtherRequest(this)">
                                <label for="requestOther"><i class="fas fa-ellipsis-h"></i> غير ذلك</label>
                            </div>
                        </div>
                        <div id="otherRequest" class="other-input" style="display: none;">
                            <input type="text" placeholder="حدد الطلب الآخر">
                        </div>
                    </div>
                    
                    <div class="form-group" id="medicalConditionsGroup" style="display:none;">
                        <label>هل يوجد أفراد بحاجة لحفظ أدوية (مريض سكر يحتاج أنسولين، أمراض كبد، إلخ)؟</label>
                        <div class="radio-group">
                            <div class="radio-item">
                                <input type="radio" name="medicalConditions" value="yes" id="medicalYes">
                                <label for="medicalYes">نعم</label>
                            </div>
                            <div class="radio-item">
                                <input type="radio" name="medicalConditions" value="no" id="medicalNo" checked>
                                <label for="medicalNo">لا</label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group" id="smallApartmentGroup" style="display:none;">
                        <label>هل الشقة صغيرة ولا يوجد مكان كافي للأثاث؟</label>
                        <div class="radio-group">
                            <div class="radio-item">
                                <input type="radio" name="smallApartment" value="yes" id="apartmentYes">
                                <label for="apartmentYes">نعم</label>
                            </div>
                            <div class="radio-item">
                                <input type="radio" name="smallApartment" value="no" id="apartmentNo" checked>
                                <label for="apartmentNo">لا</label>
                            </div>
                        </div>
                    </div>           
                </div>
                
                <div id="purchasedItemsGroup" class="form-group">
                    <label for="purchasedItems">ما تم شراؤه بالفعل:</label>
                    <textarea id="purchasedItems" rows="3" placeholder="أدخل الأغراض التي تم شراؤها مسبقاً"></textarea>
                </div>
               
                <button type="button" onclick="evaluateFamily()">
                    <i class="fas fa-calculator"></i> تقييم الاستحقاق
                </button>
            </form>
            
            <div id="result" class="result-container">
                <div class="result-header">
                    <div class="result-title">
                        <i class="fas fa-clipboard-check"></i> نتيجة التقييم
                    </div>
                    <div id="ratingBadge" class="rating-badge A">A</div>
                </div>
                
                <div id="eligibilityStatus" class="eligibility-status eligible">
                    <i class="fas fa-check-circle" style="color: #28a745; font-size: 1.5rem;"></i>
                    <div>
                        <p id="eligibilityText"></p>
                        <p id="additionalNotes" style="margin-top: 10px; font-size: 0.95rem;"></p>
                    </div>
                </div>
                
                <div class="visual-rating">
                    <div id="ratingCircle" class="rating-circle A">
                        <div class="letter">A</div>
                        <div class="text">ممتاز</div>
                    </div>
                </div>
                
                <div class="progress-container">
                    <div id="progressBar" class="progress-bar" style="width: 90%"></div>
                </div>
                <div class="progress-labels">
                    <span>أقل احتياج</span>
                    <span>أكثر احتياج</span>
                </div>
                
                <div id="washerCondition" class="washer-condition">
                    <div class="condition-title">
                        <i class="fas fa-washing-machine"></i>
                        <span>شروط الحصول على غسالة</span>
                    </div>
                    <div id="washerConditionText" class="condition-desc"></div>
                </div>
                
                <div id="bedCondition" class="calculation-info">
                    <div class="calculation-title">
                        <i class="fas fa-calculator"></i>
                        <span>حساب عدد السراير والمراتب المطلوبة</span>
                    </div>
                    <div id="bedConditionText" class="calculation-desc"></div>
                </div>
                
                <div id="devicesNeeded" class="devices-list"></div>
            </div>
        </div>
    </div>

    <script>
        // إظهار/إخفاء الحقول حسب نوع الأسرة
        document.getElementById('familyType').addEventListener('change', function() {
            const familyType = this.value;
            const providerGroup = document.getElementById('providerGroup');
            const purchasedItemsGroup = document.getElementById('purchasedItemsGroup');
            const medicalConditionsGroup = document.getElementById('medicalConditionsGroup');
            const smallApartmentGroup = document.getElementById('smallApartmentGroup');
            const elderlyGroup = document.getElementById('elderlyGroup');
            
            // إظهار حقل العائل وما تم شراؤه للعروسة فقط
            if (familyType === 'engaged' || familyType === 'married') {
                providerGroup.style.display = 'block';
                purchasedItemsGroup.style.display = 'block';
            } else {
                providerGroup.style.display = 'none';
                purchasedItemsGroup.style.display = 'none';
            }
            
            if (familyType === 'family') {
                medicalConditionsGroup.style.display = 'block';
                smallApartmentGroup.style.display = 'block';
                elderlyGroup.style.display = 'block';
            } else {
                medicalConditionsGroup.style.display = 'none';
                smallApartmentGroup.style.display = 'none';
                elderlyGroup.style.display = 'none';
            }
        });
        
        // إظهار/إخفاء نوع تلف البوتجاز ومحاولة الإصلاح عند إدخال عدد التالف
        document.getElementById('damagedStovesCount').addEventListener('input', function() {
            const damageTypeGroup = document.getElementById('stoveDamageTypeGroup');
            const repairGroup = document.getElementById('stoveRepairAttemptGroup');
            if (this.value > 0) {
                damageTypeGroup.style.display = 'block';
                repairGroup.style.display = 'block';
            } else {
                damageTypeGroup.style.display = 'none';
                repairGroup.style.display = 'none';
            }
        });
        
        // إظهار/إخفاء نوع تلف الغسالة العادية ومحاولة الإصلاح
        document.getElementById('damagedWashersCount').addEventListener('input', function() {
            const damageTypeGroup = document.getElementById('washerDamageTypeGroup');
            const repairGroup = document.getElementById('washerRepairAttemptGroup');
            if (this.value > 0) {
                damageTypeGroup.style.display = 'block';
                repairGroup.style.display = 'block';
            } else {
                damageTypeGroup.style.display = 'none';
                repairGroup.style.display = 'none';
            }
        });
        
        // إظهار/إخفاء نوع تلف الغسالة الهاف ومحاولة الإصلاح
        document.getElementById('damagedHalfWashersCount').addEventListener('input', function() {
            const damageTypeGroup = document.getElementById('halfWasherDamageTypeGroup');
            const repairGroup = document.getElementById('halfWasherRepairAttemptGroup');
            if (this.value > 0) {
                damageTypeGroup.style.display = 'block';
                repairGroup.style.display = 'block';
            } else {
                damageTypeGroup.style.display = 'none';
                repairGroup.style.display = 'none';
            }
        });
        
        // إظهار/إخفاء نوع تلف الثلاجة ومحاولة الإصلاح
        document.getElementById('damagedFridgesCount').addEventListener('input', function() {
            const damageTypeGroup = document.getElementById('fridgeDamageTypeGroup');
            const repairGroup = document.getElementById('fridgeRepairAttemptGroup');
            if (this.value > 0) {
                damageTypeGroup.style.display = 'block';
                repairGroup.style.display = 'block';
            } else {
                damageTypeGroup.style.display = 'none';
                repairGroup.style.display = 'none';
            }
        });
        
        // إدارة الحقول الإضافية عند اختيار "غير ذلك" للبوتجاز
        function toggleStoveOther(select) {
            const otherInput = document.getElementById('stoveOther');
            otherInput.style.display = select.value === 'غير ذلك' ? 'block' : 'none';
            if(select.value !== 'غير ذلك') otherInput.querySelector('input').value = '';
        }
        
        // إدارة الحقول الإضافية عند اختيار "غير ذلك" للغسالة العادية
        function toggleWasherOther(select) {
            const otherInput = document.getElementById('washerOther');
            otherInput.style.display = select.value === 'غير ذلك' ? 'block' : 'none';
            if(select.value !== 'غير ذلك') otherInput.querySelector('input').value = '';
        }
        
        // إدارة الحقول الإضافية عند اختيار "غير ذلك" للغسالة الهاف
        function toggleHalfWasherOther(select) {
            const otherInput = document.getElementById('halfWasherOther');
            otherInput.style.display = select.value === 'غير ذلك' ? 'block' : 'none';
            if(select.value !== 'غير ذلك') otherInput.querySelector('input').value = '';
        }
        
        // إدارة الحقول الإضافية عند اختيار "غير ذلك" للثلاجة
        function toggleFridgeOther(select) {
            const otherInput = document.getElementById('fridgeOther');
            otherInput.style.display = select.value === 'غير ذلك' ? 'block' : 'none';
            if(select.value !== 'غير ذلك') otherInput.querySelector('input').value = '';
        }
        
        // إدارة الحقل الإضافي لطلب "غير ذلك"
        function toggleOtherRequest(checkbox) {
            const otherInput = document.getElementById('otherRequest');
            otherInput.style.display = checkbox.checked ? 'block' : 'none';
            if (!checkbox.checked) otherInput.querySelector('input').value = '';
        }
        
        // دالة تقييم الأسرة
        function evaluateFamily() {
            // جمع البيانات الأساسية
            const familyType = document.getElementById('familyType').value;
            const familyName = document.getElementById('familyName').value;
            const familySize = parseInt(document.getElementById('familySize').value);
            const income = parseFloat(document.getElementById('income').value);
            const expenses = parseFloat(document.getElementById('expenses').value);
            const hasElderly = document.querySelector('input[name="hasElderly"]:checked')?.value === 'yes';

            // جمع بيانات الأجهزة
            const bedsCount = parseInt(document.getElementById('bedsCount').value);
            const damagedBedsCount = parseInt(document.getElementById('damagedBedsCount').value);
            const mattressesCount = parseInt(document.getElementById('mattressesCount').value);
            const damagedMattressesCount = parseInt(document.getElementById('damagedMattressesCount').value);
            const stovesCount = parseInt(document.getElementById('stovesCount').value);
            const damagedStovesCount = parseInt(document.getElementById('damagedStovesCount').value);
            const stoveDamageType =
                damagedStovesCount > 0
                    ? document.getElementById('stoveDamageType').value === 'غير ذلك'
                        ? document.getElementById('stoveOther').querySelector('input').value
                        : document.getElementById('stoveDamageType').value
                    : '';
            const hasOven = document.getElementById('hasOven').checked;
            const washersCount = parseInt(document.getElementById('washersCount').value);
            const damagedWashersCount = parseInt(document.getElementById('damagedWashersCount').value);
            const washerDamageType =
                damagedWashersCount > 0
                    ? document.getElementById('washerDamageType').value === 'غير ذلك'
                        ? document.getElementById('washerOther').querySelector('input').value
                        : document.getElementById('washerDamageType').value
                    : '';
            const halfWashersCount = parseInt(document.getElementById('halfWashersCount').value);
            const damagedHalfWashersCount = parseInt(document.getElementById('damagedHalfWashersCount').value);
            const halfWasherDamageType =
                damagedHalfWashersCount > 0
                    ? document.getElementById('halfWasherDamageType').value === 'غير ذلك'
                        ? document.getElementById('halfWasherOther').querySelector('input').value
                        : document.getElementById('halfWasherDamageType').value
                    : '';
            const fridgesCount = parseInt(document.getElementById('fridgesCount').value);
            const damagedFridgesCount = parseInt(document.getElementById('damagedFridgesCount').value);
            const fridgeDamageType =
                damagedFridgesCount > 0
                    ? document.getElementById('fridgeDamageType').value === 'غير ذلك'
                        ? document.getElementById('fridgeOther').querySelector('input').value
                        : document.getElementById('fridgeDamageType').value
                    : '';
            
            // جمع إجابات محاولة الإصلاح
            const stoveRepairAttempt = document.querySelector('input[name="stoveRepairAttempt"]:checked')?.value;
            const washerRepairAttempt = document.querySelector('input[name="washerRepairAttempt"]:checked')?.value;
            const halfWasherRepairAttempt = document.querySelector('input[name="halfWasherRepairAttempt"]:checked')?.value;
            const fridgeRepairAttempt = document.querySelector('input[name="fridgeRepairAttempt"]:checked')?.value;
            
            // جمع الطلبات مع العلم أنها قد تكون مخصصة
            const requests = Array.from(document.querySelectorAll('input[name="requests"]:checked'))
                .map(checkbox => {
                    if (checkbox.value === 'غير ذلك') {
                        const value = document.getElementById('otherRequest').querySelector('input').value.trim();
                        return { value, isCustom: true };
                    } else {
                        return { value: checkbox.value, isCustom: false };
                    }
                })
                .filter(request => request.value !== ''); // تجاهل الطلبات الفارغة

            // تحديد الأجهزة المطلوبة
            const neededDevices = [];
            const addedDevices = new Set();
            let additionalNotes = '';
            
            // التحقق من وجود غسالة عاملة
            const workingFullWashers = washersCount - damagedWashersCount;
            const workingHalfWashers = halfWashersCount - damagedHalfWashersCount;
            const hasWorkingWasher = workingFullWashers > 0 || workingHalfWashers > 0;
            let washerConditionMet = true;
            let washerConditionNote = '';

            // التحقق من وجود عائل للعروسة
            const hasProvider = document.querySelector('input[name="hasProvider"]:checked')?.value === 'yes';
            const purchasedItems = document.getElementById('purchasedItems').value;

            // إضافة دعم مالي للعروسة إذا لم يكن لها عائل
            if ((familyType === 'engaged' || familyType === 'married') && !hasProvider) {
                if (!addedDevices.has('الدعم المالي')) {
                    neededDevices.push('الدعم المالي');
                    addedDevices.add('الدعم المالي');
                }
            }

            // معالجة الطلبات
            requests.forEach(requestObj => {
                const request = requestObj.value;
                const isCustom = requestObj.isCustom;

                if (isCustom) {
                    if (!addedDevices.has(request)) {
                        neededDevices.push(request);
                        addedDevices.add(request);
                    }
                } else {
                    switch (request) {
                        case 'سرير':
                            // حساب عدد السراير المطلوبة بناءً على عدد الأفراد مقسومًا على 1.5
                            const requiredBeds = Math.ceil(familySize / 1.5);
                            const workingBeds = bedsCount - damagedBedsCount;
                            const neededBeds = Math.max(0, requiredBeds - workingBeds);
                            
                            if (neededBeds > 0 && !addedDevices.has('سرير')) {
                                neededDevices.push(`سرير (${neededBeds} عدد)`);
                                addedDevices.add('سرير');
                            }
                            break;

                        case 'مرتبة':
                            // حساب عدد المراتب المطلوبة بناءً على عدد الأفراد مقسومًا على 1.5
                            const requiredMattresses = Math.ceil(familySize / 1.5);
                            const workingMattresses = mattressesCount - damagedMattressesCount;
                            const neededMattresses = Math.max(0, requiredMattresses - workingMattresses);
                            
                            if (neededMattresses > 0 && !addedDevices.has('مرتبة')) {
                                neededDevices.push(`مرتبة (${neededMattresses} عدد)`);
                                addedDevices.add('مرتبة');
                            }
                            break;

                        case 'بوتجاز':
                            // التحقق من محاولة الإصلاح للبوتجاز التالف
                            if (damagedStovesCount > 0 && stoveRepairAttempt === 'no') {
                                additionalNotes += "لم يتم إضافة بوتجاز بسبب وجود جهاز تالف لم تتم محاولة إصلاحه. ";
                                break;
                            }
                            
                            // التحقق من شروط البوتجاز للأسرة
                            if (familyType === 'family') {
                                if (familySize < 3) {
                                    additionalNotes += "عذراً، طلب البوتجاز غير مؤهل لأن عدد أفراد الأسرة أقل من 3. ";
                                    break;
                                }
                            }
                            
                            // التحقق من وجود بوتجاز عامل أو فرن
                            const hasWorkingStove = (stovesCount - damagedStovesCount) > 0;
                            if (hasWorkingStove) {
                                additionalNotes += "لم يتم إضافة بوتجاز لأن الأسرة تملك بوتجازاً يعمل. ";
                                break;
                            }
                            if (hasOven) {
                                additionalNotes += "لم يتم إضافة بوتجاز لأن الأسرة تملك فرناً. ";
                                break;
                            }

                            if (!addedDevices.has(request)) {
                                neededDevices.push(request);
                                addedDevices.add(request);
                            }
                            break;

                        case 'غسالة':
                            // الشرط: إذا كانت الأسرة لديها غسالة عاملة (عادية أو هاف)
                            if (hasWorkingWasher) {
                                additionalNotes += "لم يتم إضافة غسالة لأن الأسرة تمتلك غسالة عادية أو هاف تعمل. ";
                                washerConditionMet = false;
                                washerConditionNote = "تمتلك الأسرة غسالة عاملة";
                                break;
                            }
                            
                            // التحقق من محاولة الإصلاح للغسالة التالفة
                            if (damagedWashersCount > 0 && washerRepairAttempt === 'no') {
                                additionalNotes += "لم يتم إضافة غسالة بسبب وجود جهاز تالف لم تتم محاولة إصلاحه. ";
                                washerConditionMet = false;
                                washerConditionNote = "وجود غسالة تالفة لم تتم محاولة إصلاحها";
                                break;
                            }
                            
                            // التحقق من محاولة الإصلاح للغسالة الهاف التالفة
                            if (damagedHalfWashersCount > 0 && halfWasherRepairAttempt === 'no') {
                                additionalNotes += "لم يتم إضافة غسالة بسبب وجود غسالة هاف تالفة لم تتم محاولة إصلاحها. ";
                                washerConditionMet = false;
                                washerConditionNote = "وجود غسالة هاف تالفة لم تتم محاولة إصلاحها";
                                break;
                            }
                            
                            // تحديد نوع الغسالة
                            let washerType = '';
                            if (familySize === 2) {
                                washerType = 'غسالة عادية';
                            } else if (familySize >= 3) {
                                washerType = 'غسالة هاف';
                            } else if (familySize === 1 && hasElderly) {
                                washerType = 'غسالة عادية (لشخص مسن)';
                            }
    
                            // إضافة الغسالة المحددة
                            if (washerType && !addedDevices.has(washerType)) {
                                neededDevices.push(washerType);
                                addedDevices.add(washerType);
                            }
                            break;

                        case 'ثلاجة':
                            // التحقق من محاولة الإصلاح للثلاجة التالفة
                            if (damagedFridgesCount > 0 && fridgeRepairAttempt === 'no') {
                                additionalNotes += "لم يتم إضافة ثلاجة بسبب وجود جهاز تالف لم تتم محاولة إصلاحه. ";
                                break;
                            }
                            
                            // إضافة الثلاجة إذا لم تكن مضافة
                            if (!addedDevices.has(request)) {
                                neededDevices.push(request);
                                addedDevices.add(request);
                            }
                            break;

                        default:
                            if (!addedDevices.has(request)) {
                                neededDevices.push(request);
                                addedDevices.add(request);
                            }
                            break;
                    }
                }
            });

            // حساب تصنيف الاستحقاق وعرض النتائج
            const netIncome = income - expenses;
            let rating = 'C';
            let ratingText = 'منخفض';
            let progressWidth = 30;

            if (netIncome <= 750) {
                rating = 'A';
                ratingText = 'عالي جداً';
                progressWidth = 90;
                additionalNotes += 'الأسرة في حاجة ماسة للمساعدة بناءً على الدخل المنخفض. ';
            } else if (netIncome <= 1500) {
                rating = 'B';
                ratingText = 'متوسط';
                progressWidth = 60;
                additionalNotes += 'الأسرة في حاجة للمساعدة ولكن ليست في حالة طارئة. ';
            } else {
                additionalNotes += 'الأسرة لديها دخل كافٍ نسبياً، يمكن النظر في حالات خاصة. ';
            }

            // عرض النتائج
            const resultDiv = document.getElementById('result');
            const eligibilityStatus = document.getElementById('eligibilityStatus');
            const devicesNeededDiv = document.getElementById('devicesNeeded');
            const ratingBadge = document.getElementById('ratingBadge');
            const ratingCircle = document.getElementById('ratingCircle');
            const progressBar = document.getElementById('progressBar');
            const washerConditionDiv = document.getElementById('washerCondition');
            const bedConditionDiv = document.getElementById('bedCondition');

            ratingBadge.className = `rating-badge ${rating}`;
            ratingBadge.textContent = rating;
            ratingCircle.className = `rating-circle ${rating}`;
            ratingCircle.querySelector('.letter').textContent = rating;
            ratingCircle.querySelector('.text').textContent = ratingText;
            progressBar.style.width = `${progressWidth}%`;

            // حساب عدد السراير والمراتب المطلوبة لعرضها في قسم الحساب
            const requiredBeds = Math.ceil(familySize / 1.5);
            const workingBeds = bedsCount - damagedBedsCount;
            const neededBeds = Math.max(0, requiredBeds - workingBeds);
            
            const requiredMattresses = Math.ceil(familySize / 1.5);
            const workingMattresses = mattressesCount - damagedMattressesCount;
            const neededMattresses = Math.max(0, requiredMattresses - workingMattresses);
            
            bedConditionDiv.innerHTML = `
                <div class="calculation-title">
                    <i class="fas fa-calculator"></i>
                    <span>حساب عدد السراير والمراتب المطلوبة</span>
                </div>
                <div class="calculation-desc">
                    <p><strong>عدد أفراد الأسرة:</strong> ${familySize}</p>
                    <p><strong>عدد السراير المطلوبة:</strong> ${familySize} / 1.5 = ${requiredBeds}</p>
                    <p><strong>السرير المتوفرة (السليمة):</strong> ${bedsCount} - ${damagedBedsCount} = ${workingBeds}</p>
                    <p><strong>عدد السراير المطلوب إضافتها:</strong> ${neededBeds}</p>
                    <p><strong>عدد المراتب المطلوبة:</strong> ${familySize} / 1.5 = ${requiredMattresses}</p>
                    <p><strong>المراتب المتوفرة (السليمة):</strong> ${mattressesCount} - ${damagedMattressesCount} = ${workingMattresses}</p>
                    <p><strong>عدد المراتب المطلوب إضافتها:</strong> ${neededMattresses}</p>
                </div>
            `;

            // تحديث حالة شرط الغسالة
            if (document.getElementById('requestWasher').checked) {
                washerConditionDiv.style.display = 'block';
    
                if (familySize === 1) {
                    washerConditionText.innerHTML = `
                        <p>لا تستحق الأسرة غسالة إلا إذا كان الفرد مسنًا</p>
                        <p><strong>عدد الأفراد:</strong> ${familySize}</p>
                        <p><strong>هل يوجد مسن؟</strong> ${hasElderly ? 'نعم' : 'لا'}</p>
                    `;
                } else if (familySize === 2) {
                    washerConditionText.innerHTML = `
                        <p>تستحق الأسرة غسالة عادية لأن عدد الأسرة 2</p>
                        <p><strong>عدد الأسرة:</strong> ${familySize}</p>
                    `;
                } else if (familySize >= 3) {
                    washerConditionText.innerHTML = `
                        <p>تستحق الأسرة غسالة هاف لأن عدد الأسرة 3 أو أكثر</p>
                        <p><strong>عدد الأسرة:</strong> ${familySize}</p>
                    `;
                }
    
                if (!washerConditionMet) {
                    washerConditionDiv.className = 'washer-condition not-met';
                    washerConditionText.innerHTML += `<p><strong>سبب عدم الاستحقاق:</strong> ${washerConditionNote}</p>`;
                } else {
                    washerConditionDiv.className = 'washer-condition';
                }
            } else {
                washerConditionDiv.style.display = 'none';
            }

            let purchasedItemsHTML = '';
            if (purchasedItems) {
                purchasedItemsHTML = `
                    <h3><i class="fas fa-shopping-cart"></i> الأغراض المشتراة مسبقاً:</h3>
                    <div class="device-item">
                        <i class="fas fa-check-circle"></i>
                        <span>${purchasedItems}</span>
                    </div>
                `;
            }

            if (neededDevices.length > 0) {
                eligibilityStatus.className = 'eligibility-status eligible';
                eligibilityStatus.innerHTML = `
                    <i class="fas fa-check-circle" style="color: #28a745; font-size: 1.5rem;"></i>
                    <div>
                        <p>الأسرة/العروسة <strong>${familyName}</strong> مؤهلة للحصول على المساعدات.</p>
                        <p style="margin-top: 10px; font-size: 0.95rem;">${additionalNotes}</p>
                    </div>
                `;

                devicesNeededDiv.innerHTML = `
                    <h3><i class="fas fa-box-open"></i> الأجهزة المعتمدة:</h3>
                    ${neededDevices
                        .map(
                            device => `
                        <div class="device-item">
                            <i class="fas fa-check-circle"></i>
                            <span>${device}</span>
                        </div>
                    `
                        )
                        .join('')}
                    ${purchasedItemsHTML}
                `;
            } else {
                eligibilityStatus.className = 'eligibility-status not-eligible';
                eligibilityStatus.innerHTML = `
                    <i class="fas fa-times-circle" style="color: #dc3545; font-size: 1.5rem;"></i>
                    <div>
                        <p>الأسرة/العروسة <strong>${familyName}</strong> غير مؤهلة بناءً على الطلبات المقدمة.</p>
                        <p style="margin-top: 10px; font-size: 0.95rem;">${additionalNotes}</p>
                    </div>
                `;
                devicesNeededDiv.innerHTML = purchasedItemsHTML;
            }

            resultDiv.style.display = 'block';
            resultDiv.scrollIntoView({ behavior: 'smooth' });
        }
    </script>
</body>
</html>